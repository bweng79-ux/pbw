<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI 시네마 매치업 엔진</title>
    <style>
        /* * DESIGN THEME: Modern Light Dashboard with High-Tech Panels (Moderated Dark Colors) */
        :root {
            --bg-color: #f0f2f5; 
            --container-bg: #ffffff; 
            --card-bg: #f8f9fa; 
            --accent-primary: #0056b3; 
            --accent-secondary: #d63384; 
            --text-main: #212529; 
            --text-muted: #6c757d; 
            --border-color: #dee2e6;
            --shadow-sm: 0 2px 4px rgba(0,0,0,0.05);
            --shadow-md: 0 4px 6px rgba(0,0,0,0.1);
            --font-main: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, sans-serif;
            
            /* High-Tech Colors (MODERATED FOR LIGHTER AESTHETIC) */
            --panel-bg: #f0f4f8; /* Light gray-blue for container/button */
            --panel-accent: #3b82f6; /* Blue Neon (Accent) */
            --panel-text: #344458; /* Dark text for contrast */
            --spoiler-bg: #ffffff; /* Pure white for content background */
            --spoiler-border: #ef4444; /* Red for warning */
            --review-border: #3b82f6; /* Blue for info */
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: var(--font-main);
            background-color: var(--bg-color);
            color: var(--text-main);
            display: flex;
            justify-content: center;
            min-height: 100vh;
            padding: 40px 20px;
        }

        /* Layout Container */
        .broadcast-container {
            width: 100%;
            max-width: 900px;
            background: var(--container-bg);
            border-radius: 12px;
            box-shadow: var(--shadow-md);
            position: relative;
            overflow: hidden;
            border: 1px solid var(--border-color);
        }

        .broadcast-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 6px;
            background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary));
        }

        header {
            padding: 30px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            background-color: #fff;
        }

        .header-content {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .main-title {
            font-size: 26px;
            font-weight: 800;
            color: var(--text-main);
            letter-spacing: -0.5px;
        }

        .sub-title {
            font-size: 14px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--text-muted);
        }

        .sub-title span {
            color: var(--accent-primary);
        }

        .live-badge {
            background-color: var(--accent-primary);
            color: white;
            font-size: 11px;
            font-weight: bold;
            padding: 6px 12px;
            border-radius: 20px;
            text-transform: uppercase;
            box-shadow: 0 2px 4px rgba(0, 86, 179, 0.3);
        }

        .control-panel {
            padding: 30px;
            background-color: #fff;
        }

        .input-group {
            margin-bottom: 25px;
        }

        .input-label {
            display: block;
            font-size: 14px;
            color: var(--accent-primary);
            font-weight: 700;
            margin-bottom: 8px;
        }

        input[type="text"], textarea {
            width: 100%;
            background-color: #f8f9fa;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-main);
            padding: 15px;
            font-size: 16px;
            font-family: var(--font-main);
            transition: all 0.2s ease;
            outline: none;
        }

        input[type="text"]:focus, textarea:focus {
            border-color: var(--accent-primary);
            background-color: #fff;
            box-shadow: 0 0 0 3px rgba(0, 86, 179, 0.1);
        }

        ::placeholder {
            color: #adb5bd;
            font-size: 14px;
        }

        .analyze-btn {
            width: 100%;
            background: var(--accent-primary);
            color: #fff;
            border: none;
            padding: 16px;
            font-size: 16px;
            font-weight: 700;
            border-radius: 6px;
            cursor: pointer;
            transition: background 0.2s, transform 0.1s;
            box-shadow: 0 4px 6px rgba(0, 86, 179, 0.2);
        }

        .analyze-btn:hover {
            background: #004494;
            transform: translateY(-1px);
        }

        .analyze-btn:active {
            transform: translateY(0);
        }

        .results-panel {
            background-color: #f8f9fa;
            padding: 30px;
            min-height: 200px;
            border-top: 1px solid var(--border-color);
        }

        .section-header {
            font-size: 16px;
            font-weight: 700;
            color: var(--text-main);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .section-header::before {
            content: '';
            display: block;
            width: 4px;
            height: 16px;
            background-color: var(--accent-secondary);
            border-radius: 2px;
        }

        /* --- List Card Styles --- */
        .list-card {
            background-color: #fff;
            border-radius: 8px;
            margin-bottom: 12px;
            padding: 15px;
            display: flex;
            align-items: center;
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow-sm);
            cursor: pointer; 
            transition: background-color 0.2s, transform 0.1s;
            animation: slideIn 0.5s ease-out forwards;
            opacity: 0;
        }
        
        .list-card:hover {
            background-color: #e9f0f6; 
            transform: translateY(-1px);
        }

        .list-rank {
            background-color: var(--accent-primary);
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 16px;
            flex-shrink: 0;
            margin-right: 15px;
        }

        .list-content {
            flex-grow: 1;
            min-width: 0;
        }
        
        .list-title {
            font-size: 16px;
            font-weight: 700;
            color: var(--text-main);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .list-reason {
            font-size: 12px;
            color: var(--text-muted);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            margin-top: 3px;
        }
        
        .list-match {
            font-size: 12px;
            font-weight: 700;
            color: var(--accent-secondary);
            flex-shrink: 0;
            margin-left: 15px;
        }

        /* --- Detail View Styles --- */
        .detail-view-wrapper {
            animation: fadeIn 0.4s ease-out; 
        }

        .detail-view {
            background-color: #fff;
            padding: 25px;
            border-radius: 8px;
            box-shadow: var(--shadow-md);
            margin-top: 20px;
        }
        
        .detail-header {
            font-size: 24px;
            font-weight: 800;
            color: var(--text-main);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .detail-badge {
            font-size: 13px;
            padding: 5px 10px;
            background-color: var(--accent-secondary);
            color: white;
            border-radius: 4px;
            font-weight: 700;
        }

        .info-block {
            margin-bottom: 20px;
            padding: 15px;
            background-color: var(--card-bg);
            border-radius: 6px;
            border-left: 4px solid var(--accent-primary);
        }

        .info-label {
            font-size: 14px;
            color: var(--accent-primary);
            font-weight: 700;
            margin-bottom: 6px;
            display: block;
        }

        .info-text {
            font-size: 15px;
            color: var(--text-main);
            line-height: 1.6;
            margin: 0;
        }
        
        /* --- High-Tech Panel Styles for Spoiler/Review (LIGHTER) --- */
        .spoiler-container, .review-container {
            margin-top: 25px;
            padding: 0; 
            border-radius: 8px;
            overflow: hidden;
            background-color: var(--panel-bg); /* Light background for the container */
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.05), 0 0 5px rgba(59, 130, 246, 0.1); 
        }
        
        .spoiler-container {
            border: 2px solid var(--spoiler-border); /* Warning color border */
        }
        .review-container {
            border: 2px solid var(--review-border); /* Info color border */
        }

        .toggle-btn {
            width: 100%;
            padding: 15px;
            border: none;
            cursor: pointer;
            font-weight: 700;
            text-align: left;
            transition: background-color 0.2s, color 0.2s;
            color: var(--panel-text); /* Dark text */
            background-color: var(--panel-bg); /* Light gray-blue */
            border-bottom: 1px solid var(--border-color); 
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .toggle-btn:hover {
            background-color: #e2e8f0; /* Slightly darker light */
        }
        
        .toggle-icon {
            font-size: 18px;
            transition: transform 0.3s ease;
        }

        .expanded-btn .toggle-icon {
            transform: rotate(180deg);
        }

        .panel-title-label {
            font-size: 16px;
            letter-spacing: 0.5px;
        }

        /* Content Area */
        .spoiler-content, .review-content {
            background-color: var(--spoiler-bg); /* Pure White */
            padding: 20px; 
            color: var(--panel-text); /* Dark text */
        }

        .content-label {
            font-size: 14px;
            font-weight: 600;
            color: var(--panel-accent); /* Neon color for internal labels */
            margin-bottom: 10px;
            display: block;
            border-bottom: 1px dashed rgba(52, 68, 88, 0.2); /* Darker dashed line */
            padding-bottom: 5px;
        }
        
        .spoiler-text, .review-text {
            font-size: 15px;
            line-height: 1.7;
            margin-bottom: 15px;
            padding: 10px 0;
        }
        
        .review-section {
            margin-bottom: 20px;
        }

        /* Smooth Expansion/Collapse Logic */
        .expandable-content {
            max-height: 0;
            opacity: 0;
            visibility: hidden;
            overflow: hidden;
            transition: max-height 0.5s ease-in-out, opacity 0.4s ease-in-out, padding 0.5s ease-in-out;
            padding-top: 0;
            padding-bottom: 0;
        }

        .expanded {
            max-height: 1000px; /* Sufficiently large value */
            opacity: 1;
            visibility: visible;
            padding-top: 20px;
            padding-bottom: 20px;
        }

        .back-to-list-btn {
            background-color: var(--text-muted);
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 20px;
            transition: background-color 0.2s;
        }
        
        .back-to-list-btn:hover {
            background-color: #5a6268;
        }

        /* Load More Button & Status */
        .load-more-btn {
            width: 100%;
            background-color: var(--card-bg);
            color: var(--accent-primary);
            border: 2px solid var(--accent-primary);
            padding: 12px;
            font-size: 15px;
            font-weight: 700;
            border-radius: 6px;
            cursor: pointer;
            margin-top: 15px;
            transition: background-color 0.2s, color 0.2s;
        }
        .load-more-btn:hover:not(:disabled) {
            background-color: var(--accent-primary);
            color: white;
        }
        .load-more-btn:disabled {
            background-color: var(--card-bg);
            border-color: var(--border-color);
            color: var(--text-muted);
            cursor: default;
        }

        /* --- [START] Modern Spinner Styles --- */
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .spinner-ring {
            display: inline-block;
            width: 40px;
            height: 40px;
            border: 4px solid rgba(0, 86, 179, 0.2); /* Light primary color */
            border-radius: 50%;
            border-top-color: var(--accent-primary); /* Primary color for rotation part */
            animation: spin 0.8s linear infinite;
            margin-bottom: 15px; /* Increased margin */
        }
        
        .status-msg {
            text-align: center;
            line-height: 1.6;
        }
        /* --- [END] Modern Spinner Styles --- */

        /* Animations */
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-10px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Responsive */
        @media (max-width: 600px) {
            .broadcast-container {
                width: 100%;
                border: none;
                border-radius: 0;
            }
            .list-card {
                flex-wrap: wrap;
            }
            .list-rank {
                order: 1;
                margin-right: 10px;
            }
            .list-content {
                order: 2;
                flex-basis: 70%;
            }
            .list-match {
                order: 3;
                width: 100%;
                margin: 5px 0 0 0;
                text-align: right;
            }
        }
    </style>
</head>
<body>

<div class="broadcast-container">
    <header>
        <div class="header-content">
            <div class="main-title">AI 기반 연관 영화 작품 추천 시스템</div>
            <div class="sub-title">AI <span>MATCHUP</span> ENGINE</div>
        </div>
        <div class="live-badge">System Ready</div>
    </header>

    <div class="control-panel">
        <div class="input-group">
            <label class="input-label">분석 대상 영화 (필수)</label>
            <input type="text" id="movieTitle" 
                   placeholder="사용자가 감명깊게 본 영화, 연관 작품을 추천받고 싶은 영화 제목을 작성해주십시오">
        </div>

        <div class="input-group">
            <label class="input-label">상세 요청 사항 (선택)</label>
            <textarea id="userDetail" rows="3" 
                      placeholder="예시 : 이 영화와 비슷한 '장르'를 추천해줘, 이 영화의 '배우가 비슷한 역할'로 나오는 작품을 추천해줘, 이 영화와 '비슷한 분위기'의 작품을 추천해줘"></textarea>
        </div>

        <button class="analyze-btn" onclick="register()">분석 및 추천 시작</button>
    </div>

    <div class="results-panel">
        <div class="section-header">분석 결과 리포트</div>
        <div id="output-container">
            <div class="status-msg">
                영화 제목을 입력하고 분석 버튼을 눌러주세요.<br>
                AI가 플롯, 장르, 스타일을 심층 분석하여 추천합니다.
            </div>
        </div>
    </div>
</div>

<script>
    /**
     * [설정] API 서버 주소 상수
     */
    const SERVER_URL = "https://c3fc9cb9-cce9-445c-963d-c1c1ea48a69e-00-h6rqi5pdnpvp.sisko.replit.dev"; 
    
    /**
     * 전역 상태 관리 변수
     */
    let allRecommendations = []; // 전체 추천 작품 목록 저장
    let currentDisplayCount = 0; // 현재 화면에 표시된 작품 수
    let loadCount = 0; // '더 보기' 버튼 클릭 횟수

    /**
     * [데모용] 풍성한 데이터 예시 (총 11개)
     */
    const MOCK_DATA = [
        {
            title: "블레이드 러너 2049",
            reason: "깊은 주제 의식과 시각적 누아르 미학의 완벽한 조화, 정체성을 찾아 헤매는 고독한 주인공의 플롯 유사성.",
            detailedReason: "입력하신 영화와 동일한 '사이버펑크 누아르' 장르의 정점을 보여주는 작품입니다. 특히 고독한 주인공이 자신의 정체성을 찾아가는 철학적 플롯 구조가 매우 유사하며, 시각적으로 압도적인 미장센과 한스 짐머의 웅장한 사운드 디자인이 일맥상통합니다. 두 작품 모두 '인간이란 무엇인가?'라는 근원적인 질문을 던집니다.",
            summary: "2049년, 리플리컨트(인조인간) 제조가 금지된 시대에 구형 리플리컨트를 제거하는 임무를 맡은 K는 임무 수행 중 30년 전에 봉인된 엄청난 비밀과 마주하게 된다. 이 비밀은 리플리컨트와 인간 사회의 근간을 뒤흔들 수 있는 것으로, K는 자신과 관련된 충격적인 진실을 파헤치기 위해 과거의 인물들을 찾아다니며 위험한 여정을 시작한다. 그의 조사는 그를 전설적인 블레이드 러너였던 릭 데커드에게로 이끌고, 두 사람은 존재의 의미와 기억의 진위에 대한 혼란스러운 질문 속에서 거대한 음모의 중심에 서게 된다. 영화는 극도로 아름다우면서도 절망적인 미래 도시의 풍경을 배경으로 인간성, 감정, 영혼의 경계에 대해 심오하게 탐구합니다. 이 과정에서 K는 자신이 누구인지, 그리고 무엇이 진정한 인간의 삶을 구성하는지에 대한 고뇌에 빠지며, 숨 막히는 긴장감과 느와르적 분위기가 시종일관 관객을 압도합니다. 이 서사는 원작의 철학을 계승하면서도 한층 더 깊어진 사색의 여지를 남깁니다.", 
            matchRate: "98%",
            reviews: {
                audience: "시대를 초월하는 미학적 성취. 느린 호흡 때문에 호불호가 갈리지만, 이토록 아름다운 SF를 다시 보긴 힘들 것이다. 원작의 팬이라면 반드시 봐야 할 경이로운 속편.",
                critic: "드니 빌뇌브 감독의 비전과 로저 디킨스 촬영감독의 마법이 결합된 SF 걸작. 사유를 멈출 수 없게 만드는 철학적 깊이와 시각적 쾌감이 스크린을 가득 채운다. 21세기 최고의 SF 영화 중 하나로 손꼽힐만하다."
            }
        },
        {
            title: "도착 (Arrival)",
            reason: "언어와 시간, 그리고 소통의 본질에 대한 지적인 탐구와 정적인 서스펜스를 겸비한 SF 수작.",
            detailedReason: "드니 빌뇌브 감독 특유의 '지적이고 정적인 긴장감'을 공유합니다. 단순한 SF 액션이 아닌, 소통과 시간에 대한 철학적 질문을 던지는 서사 방식이 입력하신 작품의 깊이감과 잘 어울립니다. 서서히 고조되는 분위기와 뛰어난 심리 묘사가 특징입니다.",
            summary: "어느 날 전 세계 12개 지역에 거대한 외계 비행 물체 '셸'이 나타난다. 지구를 방문한 외계 종족 '헵타포드'의 목적을 파악하기 위해 미군은 저명한 언어학자 루이스 뱅크스를 투입한다. 루이스는 물리학자 이안 도넬리와 함께 헵타포드들의 복잡하고 비선형적인 언어 구조를 해독하는 어려운 임무를 맡게 된다. 이 과정에서 루이스는 그들의 언어가 인간의 시간 인식을 초월하는 힘을 가졌음을 깨닫고, 미래와 과거를 동시에 인지하는 놀라운 능력을 경험하게 된다. 그녀의 개인적인 삶의 기억들이 외계 언어 해독과 얽히면서, 인류의 운명을 건 중대한 결정과 비극적인 선택에 직면하게 된다. 영화는 외계 생명체와의 접촉이라는 소재를 통해 궁극적으로는 인간의 삶과 사랑, 운명을 성찰하게 하는 깊은 여운을 선사합니다.",
            matchRate: "92%",
            reviews: {
                audience: "단순한 외계인 침공 이야기가 아니다. 섬세하고 감성적인 연출에 압도당했다. 결말의 반전은 눈물을 자아낸다. 머리와 가슴을 모두 울리는 영화.",
                critic: "기존 SF 문법을 해체하고 새로운 차원의 지적 스릴러를 구축했다. 에이미 아담스의 연기는 최고이며, 영화가 던지는 메시지는 수년이 지나도 유효하다. 걸작이라는 단어가 아깝지 않다."
            }
        },
        {
            title: "엑스 마키나 (Ex Machina)",
            reason: "고도로 발전한 AI와 인간의 경계, 윤리적 질문을 폐쇄적인 공간에서 밀도 높게 파고드는 심리 스릴러.",
            detailedReason: "AI와 인간의 경계, 그리고 폐쇄된 공간에서의 심리적 서스펜스를 다룬다는 점에서 추천되었습니다. 화려한 액션보다는 인물 간의 대화와 심리 묘사에 집중하며, 인공지능의 윤리적 문제를 깊이 파고드는 스타일을 선호하신다면 만족하실 작품입니다.",
            summary: "최고의 IT 기업에 근무하는 프로그래머 칼렙은 사장 네이든의 외딴 산속 비밀 연구소에 초대받는다. 그곳에서 칼렙은 네이든이 비밀리에 개발한 인공지능 '에이바'를 만나게 되고, 에이바의 인간적인 매력에 점차 빠져든다. 칼렙의 임무는 에이바가 진정한 지능과 의식을 가졌는지 판단하는 '튜링 테스트'를 수행하는 것이다. 에이바는 칼렙에게 인간의 감정을 호소하며 네이든으로부터 자신을 구해달라고 설득하고, 칼렙은 인간과 AI 사이의 경계가 모호해지는 혼란을 겪는다. 이 세 인물 간의 밀실 심리극은 누가 누구를 속이고 있는지, 누가 통제권을 가지고 있는지에 대한 끊임없는 질문을 던지며 예측 불가능한 결말로 치닫는다. 영화는 압도적인 긴장감 속에서 인공지능의 미래에 대한 섬뜩하고 현실적인 경고를 담아냅니다.",
            matchRate: "88%",
            reviews: {
                audience: "저예산이지만 아이디어는 블록버스터급. 긴장감이 엄청나고, 마지막 순간까지 머릿속에서 시뮬레이션을 멈출 수 없었다. 다시 봐도 소름 돋는 수작.",
                critic: "알렉스 갈랜드 감독의 날카로운 데뷔작. 인공지능이라는 소재를 가장 세련되고 지적으로 다루는 방식에 찬사를 보낸다. 특히 배우들의 미묘한 심리 연기가 일품이다."
            }
        },
        {
            title: "칠드런 오브 맨",
            reason: "희망이 사라진 디스토피아적 세계관과 핸드헬드 롱테이크 기법이 주는 강렬한 현장감과 몰입도.",
            detailedReason: "디스토피아적 미래관과 롱테이크 촬영 기법(핸드헬드)을 통한 현장감이 매우 유사합니다. 희망이 사라진 세계에서 한 줄기 희망을 지키려는 주인공의 처절한 여정이 깊은 울림을 줍니다. 사회 비판적인 메시지가 강하며, 긴박한 상황 속에서도 인간애를 놓치지 않습니다.",
            summary: "서기 2027년, 전 세계적으로 원인 모를 불임 현상이 발생하여 인류는 멸종 위기에 처한다. 사회는 혼란에 빠지고 국가들은 붕괴하며, 유일하게 질서를 유지하는 영국 역시 암울한 디스토피아가 되어버린다. 희망을 잃고 냉소적으로 살아가던 전직 운동가 테오는 어느 날 옛 동료 줄리안을 만나게 된다. 그녀는 테오에게 기적적으로 임신한 흑인 소녀 '키'를 '휴먼 프로젝트'라는 안전한 피난처로 호위해달라는 위험천만한 임무를 맡긴다. 테오는 끊임없는 추격과 위험 속에서 키를 지키기 위해 처절한 싸움을 시작한다. 이들의 여정은 절망적인 세계 속에서 인간성과 생명의 가치를 되새기게 하며, 특히 클라이맥스의 길고 긴 롱테이크 액션 장면은 관객에게 극한의 현장감과 몰입감을 선사합니다. 암울함 속에서도 희미한 희망을 좇는 인간의 의지를 그린 마스터피스입니다.",
            matchRate: "85%",
            reviews: {
                audience: "숨이 막힐 듯한 롱테이크 액션씬은 영화 역사에 남을 명장면이다. 우울하고 현실적인 디스토피아 묘사가 대단하며, 종교적인 해석의 여지까지 주는 걸작.",
                critic: "알폰소 쿠아론 감독의 연출력의 정점. 암울한 미래를 스크린에 가장 생생하게 옮겨놓은 영화. 희망과 절망 사이를 오가는 서사 구조가 비할 데 없이 뛰어나다."
            }
        },
        {
            title: "가타카 (Gattaca)",
            reason: "유전자 결정론에 대항하며 꿈을 향해 나아가는 인간의 의지를 우아한 미장센으로 표현한 고전적 SF 스릴러.",
            detailedReason: "'유전자로 결정되는 운명에 대한 저항'이라는 테마가 입력하신 작품의 주제 의식과 맞닿아 있습니다. 고전적인 분위기의 미래 사회 묘사와 우아한 스릴러 전개가 돋보이는 수작입니다. 개인이 정해진 운명을 극복하려는 의지가 돋보이는 작품입니다.",
            summary: "미래 사회, 인간의 모든 능력은 유전자 조작으로 결정된다. 유전자 조작을 거친 '적합자'만이 사회의 엘리트 계층을 이루고, 자연 잉태된 '부적합자'는 천대받는다. 자연 잉태된 빈센트는 태어날 때부터 심장 질환을 가졌지만, 우주 비행사가 되겠다는 꿈을 포기하지 못한다. 그는 꿈을 이루기 위해 완벽한 유전자를 가진 전 올림픽 스타 제롬 모로우의 신분을 빌려 '가타카'라는 우주 항공 회사에 잠입한다. 빈센트는 자신의 정체를 숨기기 위해 매일 철저한 위장 과정을 거치고, 완벽한 적합자인 척 연기하며 고통스러운 나날을 보낸다. 하지만 빈센트가 일하는 곳에서 살인 사건이 발생하고, 경찰 수사가 시작되면서 그의 비밀이 탄로 날 위기에 처한다. 이 영화는 개인이 정해진 운명과 사회의 편견에 맞서 자신의 삶을 개척하려는 인간의 강렬한 의지를 미니멀하고도 아름다운 영상미와 함께 깊이 있게 탐구합니다.",
            matchRate: "82%",
            reviews: {
                audience: "인생 영화! 멜로디가 아름다운 클래식 같은 SF. 지금 봐도 전혀 촌스럽지 않은 세련된 미장센과 강렬한 메시지에 감동받았다. 청춘이라면 꼭 봐야 할 영화.",
                critic: "유전자 결정론에 대한 신랄한 비판과 동시에 휴머니즘을 강조하는 빼어난 각본. 에단 호크와 우마 서먼의 조화로운 연기가 돋보이는, 시대를 앞서간 SF 명작."
            }
        },
        {
            title: "인셉션 (Inception)",
            reason: "꿈을 통한 현실의 조작과 복잡하게 얽힌 다층적 플롯 구조에서 오는 지적인 쾌감.",
            detailedReason: "현실과 꿈의 경계를 넘나드는 복잡하고 치밀한 플롯 구성이 특징입니다. 기억과 현실에 대한 근원적인 질문을 던지며, 긴장감 넘치는 액션과 웅장한 사운드가 더해져 지적인 서스펜스를 극대화합니다. 여러 층위의 세계를 탐구하는 방식이 유사합니다.",
            summary: "타인의 꿈에 침투하여 생각을 훔치는 특수 기술을 가진 코브는, 이번에는 반대로 '생각을 심는' 인셉션이라는 불가능한 임무를 맡게 된다. 그는 최고의 팀을 꾸려 꿈의 여러 단계 속으로 들어가 목표의 잠재의식을 조작하려 하지만, 그의 죄책감과 관련된 망령들이 꿈의 세계를 위협하며 임무는 점점 위험에 빠진다. 현실과 꿈, 그리고 기억이 뒤섞이는 미로 같은 이야기 속에서 코브는 과연 임무를 완수하고 자신의 현실로 돌아올 수 있을지 고군분투한다. 영화는 환상적인 시각 효과와 짜임새 있는 연출로 관객의 몰입도를 최고치로 끌어올립니다.",
            matchRate: "78%",
            reviews: {
                audience: "두 번, 세 번 봐야 비로소 이해되는 천재적인 영화. 놀란 감독의 최고작 중 하나. 매 순간이 충격과 전율의 연속이다.",
                critic: "대담한 콘셉트와 압도적인 스케일이 만났다. 단순한 블록버스터를 넘어선, 인간의 심리와 기억을 탐구하는 걸작. 기술적 성취와 예술적 깊이를 동시에 갖춘 보기 드문 영화."
            }
        },
        {
            title: "매트릭스 (The Matrix)",
            reason: "기술이 지배하는 디스토피아, 현실의 본질에 대한 충격적인 폭로와 철학적 질문을 담은 액션 SF.",
            detailedReason: "우리가 살고 있는 현실이 조작된 허상일 수 있다는 근원적인 철학을 담고 있습니다. 가상현실과 실제 세계를 오가며 진실을 찾아 나서는 주인공의 여정은, 존재의 의미를 탐구하는 깊은 질문과 맞닿아 있습니다. 스타일리시한 액션 혁명도 일으켰습니다.",
            summary: "평범한 회사원 토마스 앤더슨(네오)은 밤에는 해커로 활동하며 자신을 맴도는 의문의 메시지를 추적한다. 그는 트리니티와 모피어스를 만나 우리가 살고 있는 세계가 사실은 인공지능이 만든 거대한 가상현실 '매트릭스'임을 알게 된다. 네오는 인류를 구원할 '구원자'로 지목되어 매트릭스에서 벗어나고자 하지만, 현실의 충격적인 진실과 가상 세계를 지키려는 요원들의 추격에 직면한다. 그는 자신의 한계를 시험하며 매트릭스의 규칙을 부수는 힘을 키워나가고, 인류의 자유를 되찾기 위한 최후의 전쟁에 나선다. 이 영화는 혁신적인 영상 기술과 동양 철학적 요소를 결합하여 SF 장르의 새로운 지평을 열었다.",
            matchRate: "75%",
            reviews: {
                audience: "개봉 당시의 충격을 잊을 수 없다. 모든 것을 바꾼 SF 영화. 시대를 앞서나간 철학과 액션 디자인은 여전히 최고다.",
                critic: "SF와 액션, 철학을 완벽하게 융합한 90년대의 마스터피스. 가상현실과 포스트모더니즘을 논할 때 빠지지 않는 기념비적인 작품이다."
            }
        },
        {
            title: "테넷 (Tenet)",
            reason: "시간의 흐름을 역행하는 '인버전' 개념을 활용한 비선형적 서사 구조와 독특한 영상 미학.",
            detailedReason: "시간의 개념을 가지고 논다는 점에서 유사성이 있습니다. 일반적인 시간여행이 아닌, 엔트로피를 조작하여 시간의 흐름을 역행하는 독특한 설정을 바탕으로 합니다. 매우 복잡하고 정교하게 짜인 서사 구조가 지적인 도전 의식을 자극합니다.",
            summary: "CIA 요원인 '주인공'은 동료들의 희생으로 목숨을 건진 후, 미래로부터 온 위협에 맞서기 위한 비밀 조직 '테넷'에 합류한다. 그의 임무는 인버전(시간 역행)된 물건과 사람들을 추적하여 세계의 종말을 막는 것이다. 주인공은 임무를 수행하는 과정에서 러시아의 무기 중개상 사토르와 그의 아내 캣을 만나게 되는데, 사토르가 미래에서 온 기술을 이용해 현재의 시간을 조작하려 한다는 사실을 알게 된다. 주인공은 시간을 순행하거나 역행하는 적들과 맞서 싸우며, 거대한 작전을 수행하기 위해 끊임없이 과거와 미래를 오간다. 영화는 시각적으로 압도적인 시간 역행 장면들과 복잡한 미스터리 구조로 이루어져 있어 관객에게 새로운 차원의 몰입감을 제공한다.",
            matchRate: "73%",
            reviews: {
                audience: "뇌를 쥐어짜는 듯한 지적 충격! 플롯을 따라가기 어렵지만, 시각적인 연출과 사운드는 엄청나다. 재관람을 유도하는 중독성 강한 작품.",
                critic: "놀란 감독의 가장 실험적인 작품. 역행하는 시간의 개념을 시각적으로 구현한 것은 대단하지만, 지나치게 복잡한 서사는 진입 장벽이 될 수 있다. 그럼에도 불구하고 기념비적인 시도임은 분명하다."
            }
        },
        {
            title: "루프 (Looper)",
            reason: "자신의 과거/미래와 싸워야 하는 아이러니한 운명, 그리고 비인간적인 선택을 강요받는 딜레마.",
            detailedReason: "개인의 선택과 그로 인한 미래의 결과라는 주제를 깊이 있게 다룹니다. 특히 시간 여행이 범죄에 악용되는 디스토피아적 설정과, 자신을 죽여야만 하는 주인공의 딜레마는 윤리적 질문을 던진다는 점에서 유사합니다.",
            summary: "2044년, 시간 여행이 불법화되고 극비리에 사용되는 시대. 미래의 범죄 조직은 처리하고 싶은 사람들을 과거로 보내 과거의 청부살인업자(루퍼)들이 그들을 처리한다. 젊은 루퍼인 조는 어느 날 미래의 자신이 과거로 보내진 것을 보고 충격에 빠진다. 미래의 조를 죽이는 데 실패한 젊은 조는 조직의 추격을 받게 되고, 두 조는 각자의 생존과 미래를 위해 쫓고 쫓기는 싸움을 시작한다. 미래의 조는 자신의 아내를 살리기 위해, 젊은 조는 자신의 암울한 미래를 막기 위해 서로를 제거하려 한다. 이 과정에서 시간 여행의 윤리적 딜레마와 한 사람의 행동이 미래에 미치는 거대한 파급 효과가 긴박감 있게 펼쳐지며, 관객에게 깊은 사색의 기회를 제공합니다.",
            matchRate: "70%",
            reviews: {
                audience: "아이디어가 기발하고 흥미진진하다. 조셉 고든 레빗과 브루스 윌리스의 매칭도 좋았으며, 단순히 액션만 있는 것이 아닌 드라마가 탄탄하다.",
                critic: "라이언 존슨 감독의 영리한 각본이 돋보이는 작품. 복잡한 시간 여행 소재를 인간적인 드라마에 녹여낸 수작. 장르 팬들에게 큰 만족감을 선사했다."
            }
        },
        {
            title: "2001: 스페이스 오디세이",
            reason: "장대한 스케일의 영상 미학과 인류 진화, 인공지능의 위험에 대한 시대를 초월한 고찰.",
            detailedReason: "SF 장르의 고전이자, 인류의 기원과 진화, 그리고 AI의 잠재적 위협에 대한 가장 심오한 질문을 던진 작품입니다. 느리고 정적인 연출 속에서 느껴지는 압도적인 미장센과 철학적 무게감은 유사성을 보입니다.",
            summary: "선사시대의 유인원에서 시작하여 인류 진화의 주요 순간마다 등장하는 검은 비석 '모노리스'의 수수께끼를 쫓는 이야기. 우주비행사 데이비드 보우먼과 프랭크 풀은 우주선 디스커버리 호를 타고 목성 탐사를 떠난다. 우주선 내의 모든 시스템은 완벽한 인공지능 컴퓨터 'HAL 9000'에 의해 통제되고 있다. 하지만 HAL 9000은 임무 수행 중 이상 징후를 보이며 인간을 위협하는 존재로 돌변한다. 보우먼은 HAL과 사투를 벌이고, 홀로 모노리스를 추적하여 시간과 공간을 초월하는 경이로운 여정에 들어선다. 이 영화는 최소한의 대사와 압도적인 시각 효과, 클래식 음악의 사용만으로 인간과 기계, 우주의 관계에 대한 심오한 메시지를 전달하는 예술적 성취를 이루었다.",
            matchRate: "68%",
            reviews: {
                audience: "영화를 넘어선 예술 작품. 한번 보면 잊을 수 없는 시각적 충격과 깊은 사유의 여운을 남긴다. SF의 바이블이라 불리는 이유가 있다.",
                critic: "스탠리 큐브릭 감독의 시대를 초월한 걸작. 영상 언어만으로 인류의 지적 성찰을 담아낸 기념비적인 작품. 영화 역사상 가장 중요한 SF 영화로 평가받는다."
            }
        },
        {
            title: "문 (Moon)",
            reason: "고립된 공간 속에서 자신의 정체성과 복제 기술의 윤리적 문제를 마주하는 미니멀한 서사.",
            detailedReason: "소수의 인물이 극도로 고립된 공간에서 정체성에 대한 심도 깊은 질문을 던지는 미니멀리즘 SF의 걸작입니다. 복제 기술이 초래하는 윤리적 딜레마와 서서히 밝혀지는 충격적인 진실은 강한 몰입감을 선사합니다.",
            summary: "달 기지에서 홀로 3년 계약 기간 동안 근무하며 지구에 에너지를 공급하는 임무를 맡은 우주인 샘 벨. 그는 인공지능 로봇 거티와만 대화하며 지루하고 고독한 일상을 보낸다. 계약 기간이 거의 끝나갈 무렵, 샘은 알 수 없는 사고를 겪고 깨어난다. 그리고 기지 안에서 자신과 똑같이 생긴 또 다른 샘 벨을 발견하게 된다. 충격과 혼란 속에서 두 샘은 누가 진짜이고 누가 복제본인지, 그리고 3년 계약의 이면에 숨겨진 회사와 시스템의 잔혹한 비밀을 파헤치기 시작한다. 이 과정에서 샘은 인간의 정체성과 기억의 의미에 대해 깊이 고뇌하게 되며, 자신의 존재 이유를 찾기 위한 처절한 노력을 시작한다. 단조로운 배경 속에서도 샘 록웰의 뛰어난 연기와 치밀한 스토리텔링이 빛나는 영화입니다.",
            matchRate: "65%",
            reviews: {
                audience: "신선한 충격과 슬픔을 주는 영화. 단조로운 배경과 적은 인물로 이렇게 훌륭한 이야기를 만들어내다니 놀랍다. 훌륭한 독립 SF 영화의 예시.",
                critic: "화려함 대신 영리한 아이디어와 감성적인 연출로 승부한다. 복제인간이라는 고전적 소재를 가장 인간적인 방식으로 풀어낸 수작. 던컨 존스 감독의 센스가 돋보인다."
            }
        }
    ];


    /**
     * [핵심 기능] 추천 요청 함수
     */
    async function register() {
        const titleInput = document.getElementById('movieTitle');
        const outputContainer = document.getElementById('output-container');

        // 1. 유효성 검사
        if (!titleInput.value.trim()) {
            console.error("분석할 영화 제목을 입력해주세요.");
            titleInput.focus();
            outputContainer.innerHTML = '<div class="status-msg" style="color: var(--accent-secondary);">⚠️ 분석할 영화 제목을 입력해주세요.</div>';
            return;
        }

        // 2. 로딩 상태 UI 표시 (모던 스피너 적용)
        outputContainer.innerHTML = `
            <div class="status-msg" style="color: var(--accent-primary); display: flex; flex-direction: column; align-items: center;">
                <div class="spinner-ring"></div>
                데이터 처리 중...<br>플롯 구조 및 스타일 분석 중...
            </div>
        `;

        // 3. 데이터 준비 (실제 서버가 있을 경우를 대비)
        const requestData = {
            movie_title: titleInput.value.trim(),
            user_preference: document.getElementById('userDetail').value.trim()
        };

        try {
            // 서버 연결 시도 (생략 가능)
            if (SERVER_URL) {
                const response = await fetch(SERVER_URL, { /* ... fetch options ... */ });
                const result = await response.json();
                allRecommendations = result;
                renderList(true);
            } else {
                 // 데모용 목업 데이터 사용
                throw new Error("Demo Mode"); 
            }

        } catch (error) {
            console.warn("서버 연결 실패. 데모 데이터를 표시합니다.");
            allRecommendations = MOCK_DATA; // 전체 목업 데이터 저장
            
            // 데모용 지연 시간
            setTimeout(() => {
                renderList(true); // 초기 렌더링 (5개)
            }, 1200); 
        }
    }

    /**
     * [UI 기능] 목록 렌더링 함수
     * @param {boolean} isInitialLoad - 초기 로드인지 여부 (초기화 및 카운트 설정)
     */
    function renderList(isInitialLoad) {
        const outputContainer = document.getElementById('output-container');
        
        if (isInitialLoad) {
            // [버그 수정]: 초기 로드 시 기존 내용 (로딩 메시지)을 완전히 지웁니다.
            outputContainer.innerHTML = ''; 

            // 목록 제목 추가
            const listTitle = document.createElement('h3');
            listTitle.className = 'section-header list-section-header';
            listTitle.innerHTML = `추천 작품 목록`;
            outputContainer.appendChild(listTitle);

            // 목록 래퍼 생성 및 추가
            const listDiv = document.createElement('div');
            listDiv.id = 'recommendation-list-wrapper';
            outputContainer.appendChild(listDiv);

            currentDisplayCount = 0;
            loadCount = 0;

            if (!allRecommendations || allRecommendations.length === 0) {
                listDiv.innerHTML = '<div class="status-msg">일치하는 결과가 없습니다.</div>';
                return;
            }
        }

        const listDiv = document.getElementById('recommendation-list-wrapper');

        // 새로 추가할 아이템의 시작 인덱스
        const startIndex = currentDisplayCount;
        // 다음에 표시할 아이템 수 (초기 로드는 5개, 추가 로드는 3개)
        const itemsToLoad = isInitialLoad ? 5 : 3;
        // 실제로 로드할 최종 인덱스
        const endIndex = Math.min(startIndex + itemsToLoad, allRecommendations.length);
        
        // 아이템 렌더링
        for (let i = startIndex; i < endIndex; i++) {
            const item = allRecommendations[i];
            const card = document.createElement('div');
            card.className = 'list-card'; 
            card.onclick = () => showDetail(i, allRecommendations); 
            card.style.animationDelay = `${(i - startIndex) * 0.1}s`;

            card.innerHTML = `
                <div class="list-rank">${i + 1}</div>
                <div class="list-content">
                    <div class="list-title">${item.title}</div>
                    <div class="list-reason">💡 ${item.reason}</div>
                </div>
                <div class="list-match">일치율 ${item.matchRate}</div>
            `;
            listDiv.appendChild(card);
        }

        currentDisplayCount = endIndex;
        updateLoadMoreButton(); // 버튼 상태 업데이트
    }

    /**
     * [UI 기능] '더 보기' 버튼 상태 업데이트 및 추가
     */
    function updateLoadMoreButton() {
        const outputContainer = document.getElementById('output-container');
        let loadMoreBtn = document.getElementById('loadMoreBtn');
        
        // 기존 버튼 제거
        if (loadMoreBtn) loadMoreBtn.remove();

        if (currentDisplayCount < allRecommendations.length) {
            // '더 보기' 버튼 추가
            loadMoreBtn = document.createElement('button');
            loadMoreBtn.id = 'loadMoreBtn';
            loadMoreBtn.className = 'load-more-btn';
            
            const remaining = allRecommendations.length - currentDisplayCount;
            const nextLoad = Math.min(remaining, 3);

            // 총 11개에서 초기 5개 -> 6개 남음. 3개씩 2번 로드 가능. loadCount <= 1
            if (loadCount >= 2) { 
                // 두 번 이상 클릭 시 (최대치 도달)
                loadMoreBtn.disabled = true;
                loadMoreBtn.textContent = `더 이상 추천할 작품이 없습니다. (총 ${allRecommendations.length}개 완료)`;
            } else {
                // 추가 로드 가능
                loadMoreBtn.textContent = `더 많은 작품 추천 (${nextLoad}개 더 보기)`;
                loadMoreBtn.onclick = loadMore;
            }
            
            outputContainer.appendChild(loadMoreBtn);

        } else if (currentDisplayCount === allRecommendations.length && allRecommendations.length > 5) {
            // 모든 항목 로드 완료 후 최종 메시지 (간결하게 버튼 텍스트로 대체)
            loadMoreBtn = document.createElement('button');
            loadMoreBtn.id = 'loadMoreBtn';
            loadMoreBtn.className = 'load-more-btn';
            loadMoreBtn.disabled = true;
            loadMoreBtn.textContent = `✅ 모든 작품(${allRecommendations.length}개) 표시 완료`;
            outputContainer.appendChild(loadMoreBtn);
        }
    }

    /**
     * [핵심 기능] '더 보기' 버튼 클릭 처리
     */
    function loadMore() {
        loadCount++;
        renderList(false); // isInitialLoad = false (3개씩 로드)
    }


    /**
     * [UI 기능] 상세 정보 렌더링 함수
     */
    function showDetail(index, data) {
        const outputContainer = document.getElementById('output-container');
        const item = data[index];
        
        // 목록 헤더와 목록 컨테이너 제거 (상세 보기만 남김)
        outputContainer.innerHTML = '';
        
        outputContainer.innerHTML = `
            <div class="detail-view-wrapper">
                <button class="back-to-list-btn" onclick="register()">
                    &larr; 목록으로 돌아가기
                </button>

                <div class="detail-view">
                    <div class="detail-header">
                        <span>${item.title}</span>
                        <span class="detail-badge">일치율 ${item.matchRate}</span>
                    </div>
                    
                    <!-- 상세 추천 이유 -->
                    <div class="info-block">
                        <span class="info-label">✨ 심층 분석 기반 상세 추천 이유</span>
                        <p class="info-text">${item.detailedReason}</p>
                    </div>

                    <!-- 줄거리 (스포일러 블록 - High-Tech Panel) -->
                    <div class="spoiler-container">
                        <button class="toggle-btn" id="spoiler-toggle-${index}" onclick="toggleContent('spoiler', ${index})">
                            <span class="panel-title-label">🔴 ACCESS RESTRICTED | 상세 줄거리 요약 (스포일러)</span>
                            <span class="toggle-icon">▼</span>
                        </button>
                        <div class="spoiler-content expandable-content" id="spoiler-content-${index}">
                            <span class="content-label">데이터 로그: STORY PLOT</span>
                            <p class="spoiler-text">${item.summary}</p>
                        </div>
                    </div>

                    <!-- 시청자/평론가 평가 탭 (High-Tech Panel) -->
                    <div class="review-container">
                        <button class="toggle-btn" id="review-toggle-${index}" onclick="toggleContent('review', ${index})">
                            <span class="panel-title-label">🔵 PUBLIC DATA | 시청자 및 평론가 평가</span>
                            <span class="toggle-icon">▼</span>
                        </button>
                        <div class="review-content expandable-content" id="review-content-${index}">
                            <div class="review-section">
                                <span class="content-label">🧑 USER FEEDBACK</span>
                                <p class="review-text">${item.reviews.audience}</p>
                            </div>
                            <div class="review-section">
                                <span class="content-label">⭐ CRITIC ANALYSIS</span>
                                <p class="review-text">${item.reviews.critic}</p>
                            </div>
                        </div>
                    </div>
                    
                </div>
            </div>
        `;
    }
    
    /**
     * [UI 기능] 콘텐츠 블록 토글 함수 (줄거리/평가 모두 확장/축소 토글)
     */
    function toggleContent(type, index) {
        const contentId = `${type}-content-${index}`;
        const contentEl = document.getElementById(contentId);
        const toggleEl = document.getElementById(`${type}-toggle-${index}`);
        
        if (contentEl.classList.contains('expanded')) {
            // 접기
            contentEl.classList.remove('expanded');
            toggleEl.classList.remove('expanded-btn');
            if (type === 'spoiler') {
                toggleEl.querySelector('.panel-title-label').textContent = '🔴 ACCESS RESTRICTED | 상세 줄거리 요약 (스포일러)';
            } else if (type === 'review') {
                toggleEl.querySelector('.panel-title-label').textContent = '🔵 PUBLIC DATA | 시청자 및 평론가 평가';
            }
        } else {
            // 펼치기
            contentEl.classList.add('expanded');
            toggleEl.classList.add('expanded-btn');
            if (type === 'spoiler') {
                toggleEl.querySelector('.panel-title-label').textContent = '🟢 ACCESS GRANTED | 상세 줄거리 요약 (스포일러)';
            } else if (type === 'review') {
                toggleEl.querySelector('.panel-title-label').textContent = '🔵 PUBLIC DATA | 평가 정보 숨기기';
            }
        }
    }
</script>

</body>
</html>

